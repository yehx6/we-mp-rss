import{_ as N,d as V,r as E,k as $,q as P,e as L,c as u,w as t,M as c,j as s,o as p,u as I,I as W,m as n,s as h,l as B,t as D,f as q,p as G,E as H,v as J}from"./index.293d4f42.js";import{l as K,d as Q}from"./tagManagement.dc97cdc1.js";const X={class:"tag-list"},Y={key:0,class:"load-more"},Z={class:"total-count"},ee=V({__name:"TagList",setup(te){const y=E(!1),k=E(!1),v=E([]),l=E({current:1,pageSize:10,total:0}),b=E(window.innerWidth<768),x=()=>{b.value=window.innerWidth<768};$(()=>{window.addEventListener("resize",x)}),P(()=>{window.removeEventListener("resize",x)});const C=async(a=!1)=>{try{a?k.value=!0:y.value=!0;const e=await K({offset:(l.value.current-1)*l.value.pageSize,limit:l.value.pageSize});console.log(e),a?v.value=[...v.value,...e.list||[]]:v.value=e.list||[],l.value.total=e.total||0}catch{c.error("\u83B7\u53D6\u6807\u7B7E\u5217\u8868\u5931\u8D25")}finally{a?k.value=!1:y.value=!1}},z=async a=>{try{await Q(a),c.success("\u5220\u9664\u6210\u529F"),C()}catch{c.error("\u5220\u9664\u5931\u8D25")}},O=async()=>{var a;c.info("\u6B63\u5728\u751F\u6210\u5BFC\u51FA\u6587\u4EF6\uFF0C\u8BF7\u7A0D\u5019...");try{const e=await H(),o=(a=e.data)!=null?a:e,f=o instanceof Blob?o:new Blob([o],{type:"text/csv;charset=utf-8"}),_=window.URL.createObjectURL(f),d=document.createElement("a");d.href=_,d.download="\u6807\u7B7E\u5217\u8868.csv",document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(_),document.body.removeChild(d),c.success("\u6587\u4EF6\u5BFC\u51FA\u6210\u529F\uFF01")}catch(e){console.error("\u5BFC\u51FA\u6807\u7B7E\u5931\u8D25:",e);const o=(e==null?void 0:e.message)||"\u5BFC\u51FA\u6807\u7B7E\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u8054\u7CFB\u7BA1\u7406\u5458";c.error(o)}},M=async()=>{try{const a=document.createElement("input");a.type="file",a.accept=".csv",a.onchange=async e=>{var _,d,F,m;const o=(_=e.target.files)==null?void 0:_[0];if(!o)return;const f=new FormData;f.append("file",o),c.info("\u6B63\u5728\u5BFC\u5165\u6587\u4EF6\uFF0C\u8BF7\u7A0D\u5019...");try{const g=await J(f),i=(d=g.data)!=null?d:g;c.success((i==null?void 0:i.message)||"\u5BFC\u5165\u6210\u529F"),C()}catch(g){const i=(m=(F=g.response)==null?void 0:F.data)==null?void 0:m.detail,w=typeof i=="object"&&i.message?i.message:i||"\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u683C\u5F0F\u6216\u8054\u7CFB\u7BA1\u7406\u5458";c.error(w),console.error("\u5BFC\u5165\u6807\u7B7E\u65F6\u53D1\u751F\u9519\u8BEF:",g)}},a.click()}catch(a){c.error((a==null?void 0:a.message)||"\u65E0\u6CD5\u6253\u5F00\u6587\u4EF6\u9009\u62E9\u5668")}},T=a=>{l.value.current=a,C()};return $(()=>{C()}),(a,e)=>{const o=s("a-button"),f=s("icon-plus"),_=s("a-space"),d=s("a-page-header"),F=s("a-table-column"),m=s("a-tag"),g=s("a-link"),i=s("a-popconfirm"),w=s("a-table"),R=s("a-list-item-meta"),S=s("a-list-item"),U=s("a-list"),j=s("a-card");return p(),L("div",X,[u(d,{title:"\u6807\u7B7E\u7BA1\u7406",subtitle:"\u7BA1\u7406\u6587\u7AE0\u6807\u7B7E"},{extra:t(()=>[u(_,null,{default:t(()=>[u(o,{onClick:O},{icon:t(()=>[u(I(W))]),default:t(()=>[e[2]||(e[2]=n(" \u5BFC\u51FA\u6807\u7B7E "))]),_:1,__:[2]}),u(o,{onClick:M},{icon:t(()=>[u(I(h))]),default:t(()=>[e[3]||(e[3]=n(" \u5BFC\u5165\u6807\u7B7E "))]),_:1,__:[3]}),u(o,{type:"primary",onClick:e[0]||(e[0]=r=>a.$router.push("/tags/add"))},{icon:t(()=>[u(f)]),default:t(()=>[e[4]||(e[4]=n(" \u6DFB\u52A0\u6807\u7B7E "))]),_:1,__:[4]})]),_:1})]),_:1}),u(j,null,{default:t(()=>[b.value?(p(),B(U,{key:1,loading:y.value,"loading-more":k.value,data:v.value,pagination:l.value,onPageChange:T},{item:t(({item:r})=>[u(S,null,{default:t(()=>[u(R,null,{title:t(()=>[n(D(r.name)+" ",1),r.status===1?(p(),B(m,{key:0,color:"green",size:"small"},{default:t(()=>e[10]||(e[10]=[n("\u542F\u7528")])),_:1,__:[10]})):(p(),B(m,{key:1,color:"red",size:"small"},{default:t(()=>e[11]||(e[11]=[n("\u7981\u7528")])),_:1,__:[11]}))]),description:t(()=>[n(" \u521B\u5EFA\u65F6\u95F4: "+D(r.created_at),1)]),_:2},1024),u(_,null,{default:t(()=>[u(o,{type:"text",size:"small",onClick:A=>a.$router.push(`/tags/edit/${r.id}`)},{default:t(()=>e[12]||(e[12]=[n(" \u7F16\u8F91 ")])),_:2,__:[12]},1032,["onClick"]),u(i,{content:"\u786E\u8BA4\u5220\u9664\u8BE5\u6807\u7B7E\uFF1F",onOk:A=>z(r.id)},{default:t(()=>[u(o,{type:"text",status:"danger",size:"small"},{default:t(()=>e[13]||(e[13]=[n("\u5220\u9664")])),_:1,__:[13]})]),_:2},1032,["onOk"])]),_:2},1024)]),_:2},1024)]),footer:t(()=>[l.value.current*l.value.pageSize<l.value.total?(p(),L("div",Y,[u(o,{type:"primary",loading:k.value,onClick:e[1]||(e[1]=()=>{l.value.current++,C(!0)})},{default:t(()=>e[14]||(e[14]=[n(" \u52A0\u8F7D\u66F4\u591A ")])),_:1,__:[14]},8,["loading"]),q("div",Z," \u5171 "+D(l.value.total)+" \u6761 ",1)])):G("",!0)]),_:1},8,["loading","loading-more","data","pagination"])):(p(),B(w,{key:0,loading:y.value,data:v.value,pagination:l.value,onPageChange:T},{columns:t(()=>[u(F,{title:"\u6807\u7B7E\u540D\u79F0","data-index":"name"}),u(F,{title:"\u72B6\u6001","data-index":"status"},{cell:t(({record:r})=>[r.status===1?(p(),B(m,{key:0,color:"green"},{default:t(()=>e[5]||(e[5]=[n("\u542F\u7528")])),_:1,__:[5]})):(p(),B(m,{key:1,color:"red"},{default:t(()=>e[6]||(e[6]=[n("\u7981\u7528")])),_:1,__:[6]}))]),_:1}),u(F,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"created_at"}),u(F,{title:"\u64CD\u4F5C"},{cell:t(({record:r})=>[u(_,null,{default:t(()=>[u(g,{type:"primary",target:"_blank",href:`/feed/tag/${r.id}.rss`},{default:t(()=>e[7]||(e[7]=[n(" \u8BA2\u9605 ")])),_:2,__:[7]},1032,["href"]),u(o,{type:"text",onClick:A=>a.$router.push(`/tags/edit/${r.id}`)},{default:t(()=>e[8]||(e[8]=[n(" \u7F16\u8F91 ")])),_:2,__:[8]},1032,["onClick"]),u(i,{content:"\u786E\u8BA4\u5220\u9664\u8BE5\u6807\u7B7E\uFF1F",onOk:A=>z(r.id)},{default:t(()=>[u(o,{type:"text",status:"danger"},{default:t(()=>e[9]||(e[9]=[n("\u5220\u9664")])),_:1,__:[9]})]),_:2},1032,["onOk"])]),_:2},1024)]),_:1})]),_:1},8,["loading","data","pagination"]))]),_:1})])}}});var oe=N(ee,[["__scopeId","data-v-85c15ed6"]]);export{oe as default};
